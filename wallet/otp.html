<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login with OTP</title>
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

  <script>
    // Firebase config
    var firebaseConfig = {
      apiKey: "AIzaSyAteIZuLEWcdOgZQv_XPJvPhu7ruJb4N7c",
      authDomain: "tubeearn-4bb41.firebaseapp.com",
      projectId: "tubeearn-4bb41",
      storageBucket: "tubeearn-4bb41.appspot.com",
      messagingSenderId: "516486803841",
      appId: "1:516486803841:web:798acc21452c0065a0b880"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
<body>
  <div class="wallet-container">
    <h2>Login with OTP</h2>
    
    <input type="text" id="phoneNumber" placeholder="+91XXXXXXXXXX" />
    <div id="recaptcha-container"></div>
    <button onclick="sendOTP()">Send OTP</button>

    <br><br>
    <input type="text" id="otpCode" placeholder="Enter OTP" />
    <button onclick="verifyOTP()">Verify OTP</button>

    <p id="message"></p>
  </div>

  <script>
    // reCAPTCHA & OTP sending
    function sendOTP() {
      var phoneNumber = document.getElementById("phoneNumber").value;
      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
        size: 'normal',
        callback: function(response) {
          // reCAPTCHA solved
        }
      });

      firebase.auth().signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier)
        .then(function(confirmationResult) {
          window.confirmationResult = confirmationResult;
          document.getElementById("message").innerText = "OTP sent!";
        }).catch(function(error) {
          document.getElementById("message").innerText = error.message;
        });
    }

    // OTP verify
    function verifyOTP() {
      var otp = document.getElementById("otpCode").value;
      window.confirmationResult.confirm(otp).then(function(result) {
        var user = result.user;
        document.getElementById("message").innerText = "Login Successful!";
      }).catch(function(error) {
        document.getElementById("message").innerText = "Invalid OTP!";
      });
    }
  </script>
</body>
</html>
